{
  "comments": [
    {
      "key": {
        "uuid": "3dd83c8a_fafceac3",
        "filename": "deploy-boardfarm-nodes.sh",
        "patchSetId": 8
      },
      "lineNbr": 59,
      "author": {
        "id": 1016147
      },
      "writtenOn": "2019-06-12T18:11:26Z",
      "side": 1,
      "message": "This might have been here for testing, but it breaks the default network namespace for the WAN container as no default route is present and we don\u0027t set one since we assume WAN internet connectivity.\n\nI think removing this has no bad effect, running mgmt traceroute 8.8.8.8 and traceroute 8.8.8.8 on all devices seem to work as expected.",
      "revId": "fdd93c6dfb9951ea5234a3adc957ed5ccaeb5199",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "36757734_18dee068",
        "filename": "deploy-boardfarm-nodes.sh",
        "patchSetId": 8
      },
      "lineNbr": 59,
      "author": {
        "id": 1016357
      },
      "writtenOn": "2019-06-13T18:25:15Z",
      "side": 1,
      "message": "The idea is to call isolate_management() only if you\u0027re going to come across a scenario with 2 default gateways in a container.\n\nThe reason we should delete the route on line 59,\n- we add it eventually in mgmt rt_table (line 61)\n- if this function has been called, it\u0027s expected on return that a new route will be added for second interface. When that happens, if prev default route exists on main rt_table, it will create a conflict and terminate. (Does not overwrite the route)",
      "parentUuid": "3dd83c8a_fafceac3",
      "revId": "fdd93c6dfb9951ea5234a3adc957ed5ccaeb5199",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "cbb8b293_5b739fa5",
        "filename": "deploy-boardfarm-nodes.sh",
        "patchSetId": 8
      },
      "lineNbr": 59,
      "author": {
        "id": 1016147
      },
      "writtenOn": "2019-06-14T19:51:55Z",
      "side": 1,
      "message": "If we want to call this for LAN only devices then, we need to do that manually after we create the containers- you can\u0027t add the calls to each function here as these are used for all containers we create.\n\nI\u0027m not sure I\u0027m convinced of the hard... we already delete this default route when we run DHCP client on the lan device... so it just works in that case too.\n\nWhat is an example of where this would fail? (That is if we remove this line)",
      "parentUuid": "36757734_18dee068",
      "revId": "fdd93c6dfb9951ea5234a3adc957ed5ccaeb5199",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "9bf4536b_4e4a3674",
        "filename": "deploy-boardfarm-nodes.sh",
        "patchSetId": 8
      },
      "lineNbr": 59,
      "author": {
        "id": 1016357
      },
      "writtenOn": "2019-06-17T12:19:06Z",
      "side": 1,
      "message": "The function call will happen for all containers with 2 interfaces. It\u0027s not just LAN containers, also WAN containers, like the ones generated using create_container_eth1_static_linked.\n\nFor e.g. in create_container_eth1_static_linked:\n- WAN container\u0027s are not set via DHCP, their static route is being defined via the deploy script.\n- Here I\u0027d definitely want to isolate docker mgmt interface. If I don\u0027t delete the default route, following line in wan create function won\u0027t execute.\n\ndocker exec $cname ip route add default via $default_route dev eth1\n\nPlacing the isolate function here was an easier solution. \nIf we create the container first and want to call isolate later, we\u0027ll have to ensure that we call dhclient only during test runs, and the default route is added not via deploy scripts but through JSON for WAN containers. Right now it\u0027s done via deploy.",
      "parentUuid": "cbb8b293_5b739fa5",
      "revId": "fdd93c6dfb9951ea5234a3adc957ed5ccaeb5199",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": true
    }
  ]
}